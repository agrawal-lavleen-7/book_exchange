import{j as e,r as o,Y as u}from"./app-xQm2pq7_.js";import{A as g}from"./AuthenticatedLayout-pJJhUDv9.js";import"./transition-ChKOoiR9.js";function y(s){let r=0;for(let t=0;t<s.length;t++)r=s.charCodeAt(t)+((r<<5)-r);const a=(r&16777215).toString(16).toUpperCase();return"#"+"00000".substring(0,6-a.length)+a}const v=({name:s})=>{const r=y(s.slice(0,4));return e.jsx("div",{className:"h-12 w-12 p-2 rounded-full flex items-center justify-center",style:{backgroundColor:r},children:e.jsx("span",{className:"text-white font-semibold",children:s?s.slice(0,2).toUpperCase():""})})},h=v,b=({users:s,auth:r,selectedUser:a,setSelectedUser:t,fetchMessages:d})=>e.jsx("div",{className:"overflow-y-auto max-h-screen-80",children:s.data&&s.data.map(l=>e.jsxs("div",{className:`flex flex-row py-4 px-2 justify-center items-center border-b-2 ${a===l.id?"border-l-8 border-t-2 border-blue-400":""}`,onClick:()=>{t(l.id),d(l.id)},children:[e.jsx("div",{class:"w-1/4",children:e.jsx(h,{name:l.name})}),e.jsxs("div",{class:"w-full",children:[e.jsx("div",{class:"text-lg font-semibold",children:l.name}),e.jsx("div",{class:"text-lg font-semibold",children:l.email}),e.jsx("span",{class:"text-gray-500",children:"Active"})]})]},l.id))}),w=b,k=({sendMessage:s,selectedUser:r,fetchMessages:a})=>{const[t,d]=o.useState(""),l=x=>{d(x.target.value)},c=x=>{x.preventDefault(),t.trim()!==""&&(s(t),a(r),d(""))};return e.jsx("div",{class:"py-5",children:e.jsx("form",{onSubmit:c,children:e.jsx("input",{type:"text",class:"w-full bg-gray-300 py-5 px-3 rounded-xl",value:t,onChange:l,placeholder:"Type your message..."})})})},C=k,S=({messages:s,auth:r,selectedUser:a})=>e.jsx("div",{class:"flex flex-col mt-5 overflow-y-auto max-h-screen-80",children:s.data&&s.data.map(t=>e.jsxs("div",{children:[t.user_id==r.user.id&&t.sender_id==a&&e.jsx("div",{class:"flex justify-end mb-4",children:e.jsxs("div",{class:"flex items-start gap-2.5",children:[e.jsxs("div",{class:"flex flex-col w-full max-w-[320px] leading-1.5 p-4 border-gray-200 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-700",children:[e.jsxs("div",{class:"flex items-center space-x-2 rtl:space-x-reverse",children:[e.jsx("span",{class:"text-sm font-semibold text-gray-900 dark:text-white",children:t.user.name}),e.jsx("span",{class:"text-sm font-normal text-gray-500 dark:text-gray-400",children:t.created_at})]}),e.jsx("p",{class:"text-sm font-normal py-2.5 text-gray-900 dark:text-white",children:t.message}),e.jsx("span",{class:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"Delivered"})]}),e.jsx(h,{name:t.user.name})]})}),t.sender_id==r.user.id&&t.user_id==a&&e.jsx("div",{class:"flex justify-start mb-4",children:e.jsxs("div",{class:"flex items-start gap-2.5",children:[e.jsx(h,{name:t.user.name}),e.jsxs("div",{class:"flex flex-col w-full max-w-[320px] leading-1.5 p-4 border-gray-200 bg-gray-100 rounded-e-xl rounded-es-xl dark:bg-gray-700",children:[e.jsxs("div",{class:"flex items-center space-x-2 rtl:space-x-reverse",children:[e.jsx("span",{class:"text-sm font-semibold text-gray-900 dark:text-white",children:t.user.name}),e.jsx("span",{class:"text-sm font-normal text-gray-500 dark:text-gray-400",children:t.created_at})]}),e.jsx("p",{class:"text-sm font-normal py-2.5 text-gray-900 dark:text-white",children:t.message}),e.jsx("span",{class:"text-sm font-normal text-gray-500 dark:text-gray-400",children:"Delivered"})]})]})})]}))}),M=S;function A({auth:s,error:r}){const[a,t]=o.useState([]),[d,l]=o.useState([]),[c,x]=o.useState(null),[m,f]=o.useState("");o.useEffect(()=>{fetch("/api/users").then(i=>{if(!i.ok)throw new Error("Network response was not ok");return i.json()}).then(i=>t(i)).catch(i=>console.error("Error fetching user:",i))},[]);const p=i=>{fetch("/api/messages/fetch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:i,sender_id:s.user.id})}).then(n=>n.json()).then(n=>l(n)).catch(n=>console.error("Error fetching messages:",n))},j=i=>{fetch("/api/messages/send",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:i,sender_id:c,user_id:s.user.id})}).then(n=>n.json()).then(n=>{l([d,n]),f("")}).catch(n=>console.error("Error sending message:",n))};return e.jsxs(g,{user:s.user,header:e.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Messages"}),children:[e.jsx(u,{title:"Messages"}),e.jsxs("div",{class:"container mx-auto shadow-lg rounded-lg",children:[e.jsxs("div",{class:"px-5 py-5 flex justify-between items-center bg-white border-b-2",children:[e.jsx("div",{class:"font-semibold text-2xl",children:"Chat"}),e.jsx("div",{class:"w-1/2",children:e.jsx("input",{type:"text",name:"",id:"",placeholder:"search IRL",class:"rounded-2xl bg-gray-100 py-3 px-5 w-full"})}),e.jsx(h,{name:s.user.name})]}),e.jsxs("div",{class:"flex flex-row justify-between bg-white",children:[e.jsxs("div",{class:"flex flex-col w-2/5 border-r-2 overflow-y-auto",children:[e.jsx("div",{class:"border-b-2 py-4 px-2",children:e.jsx("input",{type:"text",placeholder:"search chatting",class:"py-2 px-2 border-2 border-gray-200 rounded-2xl w-full"})}),e.jsx("div",{className:"overflow-y-auto max-h-screen-80",children:e.jsx(w,{users:a,auth:s,selectedUser:c,setSelectedUser:x,fetchMessages:p})})]}),e.jsxs("div",{class:"w-full px-5 flex flex-col justify-between",children:[e.jsx(M,{auth:s,selectedUser:c,messages:d}),e.jsx(C,{newMessage:m,selectedUser:c,setNewMessage:f,sendMessage:j,fetchMessages:p})]}),e.jsx("div",{class:"w-2/5 border-l-2 px-5",children:e.jsxs("div",{class:"flex flex-col",children:[e.jsx("div",{class:"font-semibold text-xl py-4"}),e.jsx(h,{name:s.user.name}),e.jsx("div",{class:"font-semibold py-4",children:s.user.name}),e.jsx("div",{class:"font-semibold py-4",children:s.user.created_at}),e.jsx("div",{class:"font-light",children:"Lorem ipsum dolor sit amet consectetur adipisicing elit. Deserunt, perspiciatis!"})]})})]})]})]})}export{A as default};
